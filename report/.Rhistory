add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
print()
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b(values = company) +
theme_void() +
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b(values = mycols) +
theme_void() +
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b() +
theme_void() +
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b() +
theme_void() %>%
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b() +
theme_void()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b() +
theme_void() %>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
#geom_text = +
scale_color_viridis_b() +
theme(
panel.background = element_blank()
) %>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = revenue, fill = company)) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_b() +
theme(
plot.background = element_blank()
) %>%
show()
pie_chart
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue)) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
geom_text(aes(label = scales::percent(round(share,3))), position = position_stack(vjust = 0.5)) +
scale_color_viridis_d() +
theme(
plot.background = element_blank()
) %>%
show()
pie_chart
?redorder
?reorder
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))), "%")) %>%
print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))))) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
theme(
plot.background = element_blank(),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text.y = element_blank()
) %>%
show()
pie_chart
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))))) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
scale_fill_discrete(name = "Company, Market share") +
theme(
panel.background = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
) %>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
scale_fill_discrete(name = "Company, Market share") +
theme_ft_rc(grid = F) %>%
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
scale_fill_discrete(name = "Company, Market share") +
theme_minimal()%>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
scale_fill_discrete(name = "Company, Market share") +
theme_void(
panel.background = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)%>%
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
scale_fill_discrete(name = "Company, Market share") +
theme_void()%>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "", caption = "Company, Market share") +
#scale_fill_discrete(name = "Company, Market share") +
theme_void()%>%
show()
pie_chart
install.packages("hrbrthemes")
library(hrbrthemes)
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
scale_y_continuous(labels = ("", "", "", "")) %>%
show()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
scale_y_continuous(labels = c("", "", "", "")) %>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
scale_x_continuous(labels = c("", "", "", "")) %>%
show()
pie_chart
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
theme(axis.ticks = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) %>%
show()
pie_chart
?include_graphics
ggsave(file = "company_market_share.png", dpi = 100, width = 50%, height = 6)
ggsave(file = "number_of_companies.png", dpi = 100, width = 8, height = 5)
ggsave(file = "company_market_share.png", dpi = 100, width = 7, height = 5)
number_of_companies <- monthly_revenue_company%>%
select(date, company) %>%
group_by(date) %>%
unique() %>%
summarise(companies = n()) %>%
print()
number_of_companies_plot <- ggplot(
data = number_of_companies,
mapping = aes(x = date, y = companies)) +
geom_line() +
scale_x_date(limits = as.Date(c("2013-01-01", "2021-09-01"))) +
labs(x = "Year", y = "Number of companies")
ggsave(file = "number_of_companies.png", dpi = 200, width = 8, height = 5)
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
theme(axis.ticks = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) %>%
show()
ggsave(file = "company_market_share.png", dpi = 200, width = 8, height = 6)
ggsave(file = "company_market_share.png", dpi = 200, width = 8, height = 5)
In the light of the above, the Chicago Taxi industry is under great pressure. When the demand for standard taxis decreases one would think that the amounts of companies would decrease as well. Perhaps a few of the companies capture all the customers, will it be equally split among the remaining? We will start this investigation by looking at how the amount of active taxi companies has changed over the period and supply a pie chart showing the aggregated market share of each company aggrea
#Register API key to google
register_google(key="AIzaSyBT6yzDKV_DGcFGK9E-cXu0zNUD4WTJOZA")
#Get location of chicago
chicago <- geocode("Chicago, IL")
#Make leaflet map with chicago center -> make sure the maps are calculated at runtime
chicago_leaflet <- leaflet() %>%
setView(lng=chicago$lon, lat=chicago$lat, zoom=10) %>%
addProviderTiles(providers$CartoDB.Positron)
library(tidyverse)
library(sf)
library(leaflet)
library(ggmap)
library(mapview)
library(rgdal)
library(RColorBrewer)
library(janitor)
library(lubridate)
library(boot)
library(ggplot2)
library(gganimate)
library(gifski)
#Register API key to google
register_google(key="AIzaSyBT6yzDKV_DGcFGK9E-cXu0zNUD4WTJOZA")
#Get location of chicago
chicago <- geocode("Chicago, IL")
#Make leaflet map with chicago center -> make sure the maps are calculated at runtime
chicago_leaflet <- leaflet() %>%
setView(lng=chicago$lon, lat=chicago$lat, zoom=10) %>%
addProviderTiles(providers$CartoDB.Positron)
number_of_companies <- monthly_revenue_company%>%
select(date, company) %>%
group_by(date) %>%
unique() %>%
summarise(companies = n()) %>%
print()
number_of_companies_plot <- ggplot(
data = number_of_companies,
mapping = aes(x = date, y = companies)) +
geom_line() +
scale_x_date(limits = as.Date(c("2013-01-01", "2021-09-01"))) +
labs(x = "Year", y = "Number of companies")
ggsave(file = "number_of_companies.png", dpi = 300, width = 7, height = 6)
revenue_per_company <- monthly_revenue_company %>%
group_by(company) %>%
summarise(revenue = sum(revenue)) %>%
arrange(desc(revenue)) %>%
summarise(rest = )
print()
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))))) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
theme(axis.ticks = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) %>%
show()
ggsave(file = "company_market_share.png", dpi = 300, width = 8, height = 6)
company_rank <- monthly_revenue_company %>%
drop_na() %>%
group_by(year, month) %>%
mutate(rank = rank(-revenue),
revenue_lbl = paste0(" ", round(revenue / 1e3))) %>% #made to animate year
ungroup() %>%
group_by(date) %>%
filter(rank<=7) %>%
print()
revenue_per_company <- ggplot(
data = company_rank,
mapping = aes(rank, group = company,
color = as.factor(company), fill = as.factor(company))
) +
geom_tile(mapping = aes(y = revenue/2, height = revenue), show.legend = FALSE, alpha = 0.7) +
geom_text(aes(y = 0, label = paste(company, " ")), vjust = 0.2, hjust = 1, size = 8) +
geom_text(aes(y = revenue, label = revenue_lbl, hjust=0), size = 6) +
coord_flip(clip = "off", expand = FALSE) +
scale_y_continuous(labels = scales::comma) +
scale_x_reverse() +
scale_color_viridis_d() +
#scale_size(range = c(2, 12)) +
labs(x = "Revenue", y = "Company") +
guides(color = "none", fill = "none") +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position="none",
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.grid.major.x = element_line( size=.1, color="grey" ),
panel.grid.minor.x = element_line( size=.1, color="grey" ),
plot.title=element_text(size=40, hjust=0.5, face="bold", colour="grey", vjust=-1),
plot.subtitle=element_text(size=25, hjust=0.5, face="italic", color="grey"),
plot.caption = element_text(size=25, hjust=0.5, vjust=1, face="italic", color="grey"),
plot.background=element_blank(),
plot.margin = margin(2,2, 2, 13, "cm")) #top, rigth, bottom, left
anim <- revenue_per_company + transition_states(date, transition_length = 4, state_length = 1) +
view_follow(fixed_x = TRUE) +
labs(title = 'Total revenue at date {closest_state}',
subtitle  =  "Top 7 Earning Companies",
caption  = "Total Revenue in Thousand USD")
animate(anim, 1000, fps = 20,  width = 1200, height = 1000,
renderer = gifski_renderer("company_revenue.gif"))
anim <- revenue_per_company + transition_states(date, transition_length = 4, state_length = 1) +
view_follow(fixed_x = TRUE) +
labs(title = 'Total revenue in month {closest_state}',
subtitle  =  "Top 7 Earning Companies",
caption  = "Total Revenue in Thousand USD")
animate(anim, 1000, fps = 20,  width = 1200, height = 1000,
renderer = gifski_renderer("company_revenue.gif"))
number_of_companies <- monthly_revenue_company%>%
select(date, company) %>%
group_by(date) %>%
unique() %>%
summarise(companies = n()) %>%
print()
number_of_companies_plot <- ggplot(
data = number_of_companies,
mapping = aes(x = date, y = companies)) +
geom_line() +
scale_x_date(limits = as.Date(c("2013-01-01", "2021-09-01"))) +
labs(x = "Year", y = "Number of companies")
ggsave(file = "number_of_companies.png", dpi = 50, width = 4, height = 3)
ggsave(file = "number_of_companies.png", dpi = 75, width = 4, height = 3)
ggsave(file = "number_of_companies.png", dpi = 75, width = 5, height = 3)
revenue_per_company <- monthly_revenue_company %>%
group_by(company) %>%
summarise(revenue = sum(revenue)) %>%
arrange(desc(revenue)) %>%
summarise(rest = )
print()
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
revenue_per_company <- monthly_revenue_company %>%
group_by(company) %>%
summarise(revenue = sum(revenue)) %>%
arrange(desc(revenue))
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))))) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
theme(axis.ticks = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) %>%
show()
ggsave(file = "company_market_share.png", dpi = 75, width = 7, height = 6)
number_of_companies <- monthly_revenue_company%>%
select(date, company) %>%
group_by(date) %>%
unique() %>%
summarise(companies = n()) %>%
print()
number_of_companies_plot <- ggplot(
data = number_of_companies,
mapping = aes(x = date, y = companies)) +
geom_line() +
scale_x_date(limits = as.Date(c("2013-01-01", "2021-09-01"))) +
labs(x = "Year", y = "Number of companies")
show(number_of_companies_plot)
ggsave(file = "number_of_companies.png", dpi = 200, width = 5, height = 3)
revenue_per_company <- monthly_revenue_company %>%
group_by(company) %>%
summarise(revenue = sum(revenue)) %>%
arrange(desc(revenue))
other_companies <- revenue_per_company[-(1:10),] %>%
summarise(revenue = sum(revenue)) %>% print()
top10companies <- revenue_per_company %>%
head(10) %>%
add_row(company = "Other", revenue = pull(other_companies[1, 1])) %>%
mutate(share = revenue / sum(revenue),
company = paste0(company, ", ", as.character(scales::percent(round(share,2))))) %>%
print()
pie_chart <- top10companies %>%
ggplot(mapping = aes(x = "", y = share, fill = reorder(company, -share))) +
geom_bar(width = 1, stat = "identity", color = "white") +
coord_polar("y", start = 0) +
scale_color_viridis_d() +
labs(x = "", y = "") +
scale_fill_discrete(name = "Company, Market share") +
theme(axis.ticks = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) %>%
show()
ggsave(file = "company_market_share.png", dpi = 200, width = 7, height = 6)
number_of_companies <- monthly_revenue_company%>%
select(date, company) %>%
group_by(date) %>%
unique() %>%
summarise(companies = n()) %>%
print()
number_of_companies_plot <- ggplot(
data = number_of_companies,
mapping = aes(x = date, y = companies)) +
geom_line() +
scale_x_date(limits = as.Date(c("2013-01-01", "2021-09-01"))) +
labs(x = "Year", y = "Number of companies")
ggsave(file = "number_of_companies.png", dpi = 250, width = 5, height = 3)
rsconnect::deployApp()
rsconnect::deployApp()
rsconnect::deployApp(appName="report")
rsconnect::deployApp(appName="report", account="olav-forland")
options(shiny.maxRequestSize=10000*1024^2)
rsconnect::deployApp(appName="report", account="olav-forland")
options(shiny.maxRequestSize=10000*1024^2)
getOption()
shiny::getShinyOption()
shiny::getShinyOption(index.Rmd)
knitr::opts_chunk$set(echo = TRUE)
options(shiny.maxRequestSize=30*1024^2)
#options(shiny.maxRequestSize=30*1024^2)
#Naming the file index.Rmd and calling rsconnect::deployApp() posted the app succesfully on shiny server.
#It created folder named rsconnect which contains two folders: documents and shinyapps.io
getOption()
getOption(shiny.maxRequestSize)
?knitr::include_graphics
?rsconnect::deployApp
rsconnect::deployApp(appName="report", account="olav-forland")
load("~/Documents/NTNU/Lausanne/EPFL/MATH-517/Project2/report/olav_used_files/data/chicago_maps_workspace.RData")
load("~/Documents/NTNU/Lausanne/EPFL/MATH-517/Project2/report/daryna/glob.RData")
rsconnect::deployApp(appName="report", account="olav-forland")
rsconnect::deployApp(appName="report", account="olav-forland")
install.packages("bibtex")
